{
  "name": "kraken-js",
  "version": "1.0.1",
  "description": "An express-based Node.js web application bootstrapping module.",
  "keywords": [
    "node.js",
    "node",
    "javascript",
    "js",
    "web",
    "express",
    "connect"
  ],
  "main": "index.js",
  "directories": {
    "example": "./example",
    "lib": "./lib",
    "test": "./test"
  },
  "scripts": {
    "test": "NODE_ENV=_krakendev tape test/*.js",
    "cover": "NODE_ENV=_krakendev istanbul cover tape -- test/*.js",
    "lint": "jshint -c .jshintrc index.js lib/ middleware/"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/paypal/kraken-js.git"
  },
  "author": {
    "name": "Erik Toth",
    "email": "ertoth@paypal.com"
  },
  "contributors": [
    {
      "name": "Jeff Harrell",
      "email": "jeharrell@paypal.com"
    },
    {
      "name": "Trevor Livingston",
      "email": "trlivingston@paypal.com"
    },
    {
      "name": "Lenny Markus",
      "email": "lmarkus@paypal.com"
    },
    {
      "name": "Jean-Charles Sisk",
      "email": "jsisk@paypal.com"
    }
  ],
  "licenses": [
    {
      "type": "Apache 2.0",
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
    }
  ],
  "engines": {
    "node": ">=0.10.0"
  },
  "engineStrict": true,
  "devDependencies": {
    "tape": "^2.12.3",
    "istanbul": "^0.2.7",
    "jshint": "^2.5.0",
    "supertest": "^0.11.0",
    "consolidate": "^0.10.0",
    "ejs": "^1.0.0",
    "jade": "^1.3.1",
    "dustjs-linkedin": "^2.3.4",
    "express": "^4.0.0"
  },
  "peerDependencies": {
    "express": "^4.0.0"
  },
  "dependencies": {
    "caller": "~0.0.1",
    "meddleware": "^1.0.0",
    "shortstop-handlers": "^1.0.0",
    "endgame": "^0.0.3",
    "debuglog": "~0.0.2",
    "shush": "~0.0.1",
    "lusca": "^1.0.0",
    "express-enrouten": "^1.0.0",
    "core-util-is": "^1.0.1",
    "formidable": "^1.0.14",
    "shortstop": "^1.0.0",
    "confit": "^1.1.0",
    "body-parser": "^1.0.2",
    "cookie-parser": "^1.0.1",
    "static-favicon": "^1.0.2",
    "serve-static": "^1.0.4",
    "compression": "^1.0.1",
    "morgan": "^1.0.0",
    "express-session": "^1.0.3",
    "bluebird": "^1.2.3"
  },
  "readme": "# Kraken.js\n\nKraken builds upon [express](http://expressjs.com/) and enables environment-aware, dynamic configuration, advanced middleware capabilities, security, and app lifecycle events.\n\n\n## Basic Usage\n\n```javascript\n'use strict';\n\nvar express = require('express'),\n    kraken = require('kraken-js');\n\nvar app = express();\napp.use(kraken());\napp.listen(8000);\n```\n\n\n## API\n\n`kraken([options])`\n\nkraken-js is used just like any normal middleware, however it does more than just return a function; it configures a\ncomplete express 4 application. See below for a list of features, but to get started just use it like middleware.\n\n```javascript\napp.use(kraken());\n// or to specify a mountpath for your application:\n// app.use('/mypath', kraken());\n\n// Note: mountpaths can also be configured using the\n// `express:mountpath` config setting, but that setting\n// will be overridden if specified in code.\n```\n\n### Options\nPass the following options to kraken via a config object such as this:\n\n```javascript\nvar options = {\n    onconfig: function (config, callback) {\n        // do stuff\n        callback(null, config);\n    }\n};\n\n// ...\n\napp.use(kraken(options));\n```\nNote: All kraken-js configuration settings are optional.\n\n#### `basedir` (*String*, optional)\nThe working directory for kraken to use. kraken loads configuration files,\nroutes, and registers middleware so this directory is the path against all relative paths are resolved. The default value\nis the directory of the file that uses kraken, which is generally `index.js` (or `server.js`).\n\n#### `onconfig` (*Function*, optional)\nProvides an asynchronous hook for loading additional configuration. When invoked, a\n[confit](https://github.com/krakenjs/confit) configuration object containing all loaded configuration value passed\nas the first argument, and a callback as the second. The signature of this handler is `function (config, callback)`\nand the callback is a standard error-back which accepts an error as the first argument and the config object as the\nsecond, e.g. `callback(null, config)`.\n\n#### `protocols` (*Object*, optional)\nProtocol handler implementations for use when processing configuration. For more information on protocols\nsee [shortstop](https://github.com/krakenjs/shortstop) and [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers).\nBy default, kraken comes with a set of shortstop protocols which are described in the \"Config Protocols\" section below,\nbut you can add your own by providing an object with the protocol names as the keys and their implementations as\nproperties, for example:\n```javascript\nvar options = {\n    protocols: {\n        file: function file(value, callback) {\n            fs.readFile(value 'utf8', callback)\n        }\n    }\n};\n```\n\n#### `uncaughtException` (*Function*, optional)\nHandler for `uncaughtException` errors. See the [endgame](https://github.com/totherik/endgame) module for defaults.\n\n\n## Config Protocols\nkraken comes with the following shortstop protocol handlers by default:\n#### `import:`\nMerge the contents of the specified file into configuration under a given key.\n```json\n{\n    \"foo\": \"import:./myjsonfile\"\n}\n```\n\n#### `config:`\nReplace with the value at a given key. Note that the keys in this case are dot (.) delimited.\n```json\n{\n    \"foo\": {\n        \"bar\": true\n    },\n    \"foobar\": \"config:foo.bar\"\n}\n```\n\n#### `path:`\nThe path handler is documented in the [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers#handlerspathbasedir) repo.\n\n#### `file:`\nThe file handler is documented in the [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers#handlersfilebasedir-options) repo.\n\n#### `base64:`\nThe base64 handler is documented in the [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers#handlersbase64) repo.\n\n#### `env:`\nThe env handler is documented in the [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers#handlersenv) repo.\n\n#### `require:`\nThe require handler is documented in the [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers#handlersrequirebasedir) repo.\n\n#### `exec:`\nThe exec handler is documented in the [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers#handlersexecbasedir) repo.\n\n#### `glob:`\nThe glob handler is documented in the [shortstop-handlers](https://github.com/krakenjs/shortstop-handlers#handlersglobbasediroptions) repo.\n\n\n\n\n## Features\n\n\n### Configuration\n\n\n#### Environment-aware\n\nUsing environment suffixes, configuration files are applied and overridden according to the current environment as set\nby `NODE_ENV`. The application looks for a `./config` directory relative to the basedir and looks for `config.json` as the baseline config specification. JSON files matching the current env are processed and loaded. Additionally, JSON configuration files may contain comments.\n\nValid `NODE_ENV` values are `undefined` or `dev[elopment]`, `test[ing]`, `stag[e|ing]`, `prod[uction]`. Simply\nadd a config file with the name, to have it read only in that environment, e.g. `config/development.json`.\n\n\n### Middleware\n\nMuch like configuration, you shouldn't need to write a lot of code to determine what's in your middleware chain. [meddleware](https://github.com/paypal/meddleware) is used internally to read,\nresolve, and register middleware with your express application. You can either specify the middleware in your config.json or {environment}.json, (or) import it from a separate json file using the import protocol mentioned above.\n\n\n### Application Security\n\nKraken uses [lusca](https://github.com/paypal/lusca) to secure your applications, so that you don't need to think about it. Techniques like CSRF, XFRAMES, and CSP are enabled automatically while others can be opted into. All are customizeable through configuration.\n\n\n### Lifecycle Events\n\nKraken adds support for additional events to your express app instance:  \n\n* `start` - the application has safely started and is ready to accept requests\n* `shutdown` - the application is shutting down, no longer accepting requests\n* `stop` - the http server is no longer connected or the shutdown timeout has expired\n\n\n\n### Configuration-based `express` Settings\nSince express instances are themselves config objects, the convention is to set values on the app instance for use by\nexpress internally as well as other code across the application. kraken-js allows you to configure express via JSON.\nAny properties are supported, but kraken-js defaults include:\n```json\n{\n    \"express\": {\n        \"env\": \"\", // NOTE: `env` is managed by the framework. This value will be overwritten.\n        \"x-powered-by\": false,\n        \"trust proxy\": false,\n        \"jsonp callback name\": null,\n        \"json replacer\": null,\n        \"json spaces\": 0,\n        \"case sensitive routing\": false,\n        \"strict routing\": false,\n        \"view cache\": true,\n        \"view engine\": null,\n        \"views\": \"path:./views\",\n        \"route\": \"/\"\n    }\n}\n```\n\nAdditional notes:\n- The `env` setting will be set to the environment value as derived by kraken-js, so what is put here will be overwritten\nat runtime.\n- Set the `view engine` property to the one of the `view engines` property names (see the section `View Engine Configuration`)\nto enable it for template rendering.\n- The optional `view` property is a special case in which you can set a path to a module which exports a constructor implementing\nthe view API as defined by the module `express/lib/view`. If set, kraken-js will attempt to load the specified module and\nconfigure express to use it for resolving views.\n\nFor example:\n\n```json\n{\n    \"express\": {\n        \"view\": \"path:./lib/MyCustomViewResolver\"\n    }\n}\n```\n\n\n### View Engine Configuration\nkraken-js looks to the `view engines` config property to understand how to load and initialize renderers. The value of the\n`view engines` property is an object mapping the desired file extension to engine config settings. For example:\n```json\n{\n    \"view engines\": {\n        \"jade\": {\n            \"module\": \"consolidate\"\n        },\n        \"html\": {\n            \"name\": \"ejs\",\n            \"module\": \"ejs\",\n            \"renderer\": \"renderFile\"\n        },\n        \"dust\": {\n            \"module\": \"adaro\",\n            \"renderer\": {\n                \"method\": \"dust\",\n                \"arguments\": [{ \"cache\": false }]\n            }\n        },\n        \"js\": {\n            \"module\": \"adaro\",\n            \"renderer\": {\n                \"method\": \"js\",\n                \"arguments\": [{ \"cache\": false }]\n            }\n        }\n    }\n}\n```\n\nThe available engine configuration options are:\n\n- `module` (*String*) - This is the node module that provides the renderer implementation. The value can be the name of a\nmodule installed via npm, or it can be a module in your project referred to via file path, for example `\"module\": \"path:./lib/renderer\"`.\n- `name` (*String*, optional) - Set this if the name of the rendering engine is different from the desired file extension.\nFor example, you chose to use ejs, but want to use the \"html\" file extension for your templates. Additionally, if the\nrenderer function exported by the module is not the file extension and a \"renderer\" property is not defined, this value will be used.\n- `renderer` (*String|Object*, optional) - The renderer property allows you to explicitly identify the property or the\nfactory method exported by the module that should be used when settings the renderer. Set the value to a String to identify\nthat the renderer is exported by that name, or an object with the properties \"method\" and \"arguments\" to identify a factory method.\nFor example, using ejs you could set this property to \"renderFile\" or \"__express\" as the ejs module exports a renderer directly.\n\n\n\n## Tests\n```bash\n$ npm test\n```\n\n## Coverage\n````bash\n$ npm run-script cover && open coverage/lcov-report/index.html\n```\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/paypal/kraken-js/issues"
  },
  "_id": "kraken-js@1.0.1",
  "dist": {
    "shasum": "58fad38c76d8df11d90f96c79b2296e2d393b35d"
  },
  "_from": "kraken-js@^1.0.1",
  "_resolved": "https://registry.npmjs.org/kraken-js/-/kraken-js-1.0.1.tgz"
}
